# ImageProcessor 區域放大與編輯功能說明

## 新增功能概述

本專案在 `copilot/add-zoom-and-edit-functionality` 分支中新增了以下功能：

### 1. 區域放大功能（Region Zoom）

使用者可以透過滑鼠拖曳選取圖片中的特定區域，並將該區域放大至指定倍率，然後在新視窗中檢視和編輯。

#### 使用方式：

1. **開啟圖片**：點擊「檔案」→「開啟檔案」或工具列的開啟按鈕
2. **啟用區域放大模式**：點擊「工具」→「區域放大」或工具列的區域放大按鈕（快捷鍵：Ctrl+Z）
3. **選取區域**：
   - 滑鼠游標會變成十字游標
   - 在圖片上按住滑鼠左鍵並拖曳，會出現矩形選取框（QRubberBand）
   - 釋放滑鼠左鍵完成選取
4. **設定放大倍率**：彈出對話框讓使用者輸入放大倍率（1.0 - 10.0 倍）
5. **開啟編輯視窗**：選定的區域會以指定倍率放大，並在新的「放大編輯器」視窗中顯示

#### 技術細節：

- 使用 `QRubberBand` 提供視覺化的選取矩形
- 自動處理座標轉換（視窗座標 → 圖片座標）
- 自動處理圖片縮放比例
- 使用 `Qt::SmoothTransformation` 確保放大品質

### 2. 放大編輯器（ZoomEditor）

放大編輯器是一個獨立的視窗，提供以下功能：

#### 2.1 圖片顯示
- 使用 `QScrollArea` 容納放大後的圖片
- 支援捲軸瀏覽大型放大圖片

#### 2.2 畫筆工具
- **顏色選擇**：點擊「選擇顏色」按鈕可透過顏色對話框選擇畫筆顏色
- **筆刷大小**：使用工具列的 SpinBox 控制項調整筆刷大小（1-50 像素）
- **繪圖方式**：
  - 按住滑鼠左鍵並移動即可繪圖
  - 使用圓滑筆觸（RoundCap、RoundJoin）
  - 支援連續繪製

#### 2.3 另存新檔
- 點擊「另存新檔」按鈕可將編輯後的圖片儲存
- 支援格式：PNG、JPEG、BMP
- 儲存成功會顯示確認訊息

#### 2.4 清除塗鴉
- 點擊「清除塗鴉」按鈕可以移除所有繪製內容
- 恢復到原始放大後的圖片狀態

## 程式架構

### 新增檔案

1. **zoomeditor.h**：ZoomEditor 類別定義
2. **zoomeditor.cpp**：ZoomEditor 實作

### 修改檔案

1. **ip.h**：
   - 新增 `zoomSelectionAction` 動作
   - 新增 `zoomSelectionMode` 布林變數控制選取模式
   - 新增 `selectionStart`、`selectionEnd` 記錄選取座標
   - 新增 `rubberBand` 指標用於視覺化選取框
   - 新增 `enableZoomSelection()` 槽函數

2. **ip.cpp**：
   - 修改 `mousePressEvent()`：處理選取開始
   - 修改 `mouseMoveEvent()`：更新選取矩形
   - 修改 `mouseReleaseEvent()`：處理選取完成並開啟編輯視窗
   - 新增 `enableZoomSelection()` 實作

3. **ImagerProcessor.pro**：
   - 加入 `zoomeditor.h` 和 `zoomeditor.cpp`

4. **.gitignore**：
   - 排除編譯產生的二進位檔案和 MOC 檔案

## 建置說明

### 系統需求
- Qt 5.15 或更高版本
- C++17 編譯器
- Qt Widgets 模組

### 建置步驟

```bash
# 產生 Makefile
qmake ImagerProcessor.pro

# 編譯
make

# 執行
./ImagerProcessor
```

## 使用流程範例

1. 啟動程式
2. 開啟圖片（例如：相片/111.png）
3. 點擊「區域放大」按鈕或按 Ctrl+Z
4. 在圖片上拖曳選取想要放大的區域
5. 輸入放大倍率（例如：2.5）
6. 在新開啟的「放大編輯器」視窗中：
   - 點擊「選擇顏色」選擇想要的畫筆顏色
   - 調整筆刷大小
   - 在圖片上繪製標記或註解
   - 點擊「另存新檔」儲存編輯結果
   - 或點擊「清除塗鴉」重新開始

## 主要特色

1. **直覺的操作介面**：使用拖曳方式選取區域，符合一般影像處理軟體的操作習慣
2. **彈性的放大倍率**：使用者可自訂 1.0 到 10.0 倍的放大倍率
3. **獨立的編輯視窗**：放大後的圖片在獨立視窗中顯示，不影響原始主視窗
4. **完整的繪圖工具**：提供顏色選擇、筆刷大小調整等功能
5. **便捷的檔案操作**：支援多種圖片格式的另存新檔功能
6. **可復原的編輯**：提供清除功能可以重新開始編輯

## 技術亮點

- 使用 Qt 的 `QRubberBand` 提供視覺回饋
- 正確處理座標系統轉換
- 使用 `QPainter` 實現流暢的繪圖功能
- 妥善管理視窗生命週期（使用 `new` 創建獨立視窗）
- 完整的錯誤處理（檢查圖片是否載入、選取區域是否有效等）

## 未來可能的改進

1. 支援更多繪圖工具（矩形、圓形、文字等）
2. 增加復原/重做功能
3. 支援圖層管理
4. 加入濾鏡效果
5. 支援批次處理
